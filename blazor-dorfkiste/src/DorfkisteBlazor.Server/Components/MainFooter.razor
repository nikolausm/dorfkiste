@inject IJSRuntime JSRuntime

<footer class="main-footer">
    <!-- Main Footer Content -->
    <div class="footer-content">
        <MudContainer MaxWidth="MaxWidth.ExtraLarge">
            <MudGrid Spacing="4">
                <!-- Ausleihen Section -->
                <MudItem xs="6" sm="6" md="3" lg="2">
                    <MudText Typo="Typo.h6" Class="footer-section-title">
                        Ausleihen
                    </MudText>
                    <MudList T="string" Dense="true" Class="footer-list">
                        <MudListItem T="string" Value="@("item")" Href="/auth/signup" Class="footer-link">
                            <MudListItemText Primary="Registrierung" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/categories" Class="footer-link">
                            <MudListItemText Primary="Alle Kategorien" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/items" Class="footer-link">
                            <MudListItemText Primary="Artikel durchsuchen" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/help/how-to-rent" Class="footer-link">
                            <MudListItemText Primary="Wie funktioniert's?" />
                        </MudListItem>
                    </MudList>
                </MudItem>

                <!-- Verleihen Section -->
                <MudItem xs="6" sm="6" md="3" lg="2">
                    <MudText Typo="Typo.h6" Class="footer-section-title">
                        Verleihen
                    </MudText>
                    <MudList T="string" Dense="true" Class="footer-list">
                        <MudListItem T="string" Value="@("item")" Href="/items/new" Class="footer-link">
                            <MudListItemText Primary="Artikel einstellen" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/help/pricing" Class="footer-link">
                            <MudListItemText Primary="Preisgestaltung" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/help/safety" Class="footer-link">
                            <MudListItemText Primary="Sicherheit" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/help/insurance" Class="footer-link">
                            <MudListItemText Primary="Versicherung" />
                        </MudListItem>
                    </MudList>
                </MudItem>

                <!-- Community Section -->
                <MudItem xs="6" sm="6" md="3" lg="2">
                    <MudText Typo="Typo.h6" Class="footer-section-title">
                        Community
                    </MudText>
                    <MudList T="string" Dense="true" Class="footer-list">
                        <MudListItem T="string" Value="@("item")" Href="/about" Class="footer-link">
                            <MudListItemText Primary="Über Dorfkiste" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/blog" Class="footer-link">
                            <MudListItemText Primary="Blog" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/forum" Class="footer-link">
                            <MudListItemText Primary="Forum" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/success-stories" Class="footer-link">
                            <MudListItemText Primary="Erfolgsgeschichten" />
                        </MudListItem>
                    </MudList>
                </MudItem>

                <!-- Hilfe & Kontakt Section -->
                <MudItem xs="6" sm="6" md="3" lg="2">
                    <MudText Typo="Typo.h6" Class="footer-section-title">
                        Hilfe & Kontakt
                    </MudText>
                    <MudList T="string" Dense="true" Class="footer-list">
                        <MudListItem T="string" Value="@("item")" Href="/help" Class="footer-link">
                            <MudListItemText Primary="Hilfe-Center" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/contact" Class="footer-link">
                            <MudListItemText Primary="Kontakt" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/faq" Class="footer-link">
                            <MudListItemText Primary="Häufige Fragen" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/resolution-center" Class="footer-link">
                            <MudListItemText Primary="Konfliktlösung" />
                        </MudListItem>
                    </MudList>
                </MudItem>

                <!-- Über Dorfkiste Section -->
                <MudItem xs="12" sm="12" md="12" lg="2">
                    <MudText Typo="Typo.h6" Class="footer-section-title">
                        Über Dorfkiste
                    </MudText>
                    <MudList T="string" Dense="true" Class="footer-list">
                        <MudListItem T="string" Value="@("item")" Href="/company" Class="footer-link">
                            <MudListItemText Primary="Unternehmen" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/press" Class="footer-link">
                            <MudListItemText Primary="Presse" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/careers" Class="footer-link">
                            <MudListItemText Primary="Karriere" />
                        </MudListItem>
                        <MudListItem T="string" Value="@("item")" Href="/partners" Class="footer-link">
                            <MudListItemText Primary="Partner" />
                        </MudListItem>
                    </MudList>
                </MudItem>

                <!-- Newsletter & Social Section -->
                <MudItem xs="12" lg="2">
                    <MudText Typo="Typo.h6" Class="footer-section-title">
                        Newsletter
                    </MudText>
                    <MudText Typo="Typo.body2" Class="mb-3" Color="Color.Secondary">
                        Bleiben Sie auf dem Laufenden über neue Artikel und Angebote in Ihrer Nachbarschaft.
                    </MudText>
                    
                    <div class="newsletter-form">
                        <MudTextField @bind-Value="@_newsletterEmail"
                                      Placeholder="Ihre E-Mail-Adresse"
                                      Variant="Variant.Outlined"
                                      Dense="true"
                                      Class="newsletter-input" />
                        <MudButton Variant="Variant.Filled"
                                   Color="Color.Primary"
                                   OnClick="@SubscribeNewsletter"
                                   Class="newsletter-button mt-2"
                                   FullWidth="true">
                            Anmelden
                        </MudButton>
                    </div>

                    <!-- Social Media Links -->
                    <div class="social-media mt-4">
                        <MudText Typo="Typo.body2" Class="mb-2">Folgen Sie uns:</MudText>
                        <div class="d-flex gap-2">
                            <MudIconButton Icon="@Icons.Custom.Brands.Facebook"
                                           Color="Color.Primary"
                                           Href="https://facebook.com/dorfkiste"
                                           Target="_blank"
                                           Size="Size.Small" />
                            <MudIconButton Icon="@Icons.Custom.Brands.Twitter"
                                           Color="Color.Info"
                                           Href="https://twitter.com/dorfkiste"
                                           Target="_blank"
                                           Size="Size.Small" />
                            <MudIconButton Icon="@Icons.Custom.Brands.Instagram"
                                           Color="Color.Secondary"
                                           Href="https://instagram.com/dorfkiste"
                                           Target="_blank"
                                           Size="Size.Small" />
                            <MudIconButton Icon="@Icons.Custom.Brands.LinkedIn"
                                           Color="Color.Primary"
                                           Href="https://linkedin.com/company/dorfkiste"
                                           Target="_blank"
                                           Size="Size.Small" />
                        </div>
                    </div>
                </MudItem>
            </MudGrid>
        </MudContainer>
    </div>

    <!-- Bottom Footer -->
    <div class="footer-bottom">
        <MudContainer MaxWidth="MaxWidth.ExtraLarge">
            <div class="d-flex flex-column flex-md-row align-center justify-space-between">
                <!-- Copyright and Legal Links -->
                <div class="d-flex flex-wrap align-center gap-4 mb-3 mb-md-0">
                    <MudText Typo="Typo.caption" Color="Color.Secondary">
                        © 2024 Dorfkiste
                    </MudText>
                    <MudLink Href="/privacy" Typo="Typo.caption" Class="footer-legal-link">
                        Datenschutz
                    </MudLink>
                    <MudLink Href="/terms" Typo="Typo.caption" Class="footer-legal-link">
                        AGB
                    </MudLink>
                    <MudLink Href="/cookies" Typo="Typo.caption" Class="footer-legal-link">
                        Cookies
                    </MudLink>
                    <MudLink Href="/imprint" Typo="Typo.caption" Class="footer-legal-link">
                        Impressum
                    </MudLink>
                </div>

                <!-- Payment Methods -->
                <div class="d-flex align-center gap-2">
                    <MudText Typo="Typo.caption" Color="Color.Secondary" Class="mr-2">
                        Sichere Zahlung:
                    </MudText>
                    <div class="d-flex gap-1">
                        <MudPaper Class="payment-icon" Elevation="0">
                            <MudIcon Icon="@Icons.Material.Filled.CreditCard" Size="Size.Small" />
                        </MudPaper>
                        <MudPaper Class="payment-icon" Elevation="0">
                            <MudText Typo="Typo.caption" Class="payment-text">PayPal</MudText>
                        </MudPaper>
                        <MudPaper Class="payment-icon" Elevation="0">
                            <MudText Typo="Typo.caption" Class="payment-text">SEPA</MudText>
                        </MudPaper>
                        <MudPaper Class="payment-icon" Elevation="0">
                            <MudIcon Icon="@Icons.Material.Filled.Security" Size="Size.Small" />
                        </MudPaper>
                    </div>
                </div>
            </div>
        </MudContainer>
    </div>

    <!-- Back to Top Button -->
    <MudScrollToTop>
        <MudFab Color="Color.Success" 
               StartIcon="@Icons.Material.Filled.KeyboardArrowUp" 
               Size="Size.Medium" />
    </MudScrollToTop>
</footer>

@code {
    private string _newsletterEmail = string.Empty;

    protected override async Task OnInitializedAsync()
    {
        // Initialize any non-JS related state here
        await base.OnInitializedAsync();
    }
    
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        if (firstRender)
        {
            try
            {
                // Store component initialization in memory
                await JSRuntime.InvokeVoidAsync("console.log", "UI-Dev: Initializing MainFooter component");
                await JSRuntime.InvokeVoidAsync("console.log", "UI-Dev: MainFooter initialized with responsive design and newsletter signup");
            }
            catch (Exception ex)
            {
                // Log exception but don't throw - this is for debugging only
                Console.WriteLine($"JS Interop failed: {ex.Message}");
            }
        }
    }

    private async Task SubscribeNewsletter()
    {
        if (string.IsNullOrWhiteSpace(_newsletterEmail))
        {
            return;
        }

        try
        {
            // Here you would typically call an API to subscribe the user
            // For now, just simulate the subscription
            await Task.Delay(500);
            
            // Show success message
            // Snackbar.Add("Erfolgreich für Newsletter angemeldet!", Severity.Success);
            
            // Clear the input
            _newsletterEmail = string.Empty;
            StateHasChanged();
            
            Console.WriteLine($"UI-Dev: Newsletter subscription attempted for: {_newsletterEmail}");
        }
        catch (Exception ex)
        {
            Console.WriteLine($"Newsletter subscription error: {ex.Message}");
            // Snackbar.Add("Fehler beim Anmelden für Newsletter", Severity.Error);
        }
    }
}

<style>
    /* eBay-Style Main Footer */
    .main-footer {
        background-color: #f7f7f7;
        border-top: 1px solid #e5e5e5;
        margin-top: auto;
    }

    .footer-content {
        padding: 48px 0 24px 0;
    }

    .footer-section-title {
        font-weight: 600;
        margin-bottom: 16px;
        color: #0064d2;
        font-size: 1rem;
    }

    .footer-list {
        padding: 0;
    }

    .footer-link {
        padding: 4px 0;
        min-height: auto;
    }

    .footer-link:hover {
        background-color: rgba(0, 100, 210, 0.04);
    }

    .footer-link .mud-list-item-text {
        margin: 0;
    }

    .footer-link .mud-typography {
        font-size: 0.875rem;
        color: #6b7280;
        transition: color 0.2s ease;
    }

    .footer-link:hover .mud-typography {
        color: #0064d2;
    }

    .newsletter-form {
        margin-top: 16px;
    }

    .newsletter-input .mud-input-control {
        background-color: white;
    }

    .newsletter-button {
        border-radius: 18px;
        background-color: #0064d2;
        font-weight: 600;
        text-transform: none;
    }
    
    .newsletter-button:hover {
        background-color: #004c9c;
        transform: translateY(-1px);
    }

    .social-media .mud-icon-button {
        border-radius: 50%;
        border: 1px solid #e5e7eb;
        background-color: white;
        transition: all 0.2s ease;
    }

    .social-media .mud-icon-button:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
    }

    .footer-bottom {
        background-color: #f0f0f0;
        border-top: 1px solid #e5e5e5;
        padding: 16px 0;
    }

    .footer-legal-link {
        color: #6b7280;
        text-decoration: none;
        transition: color 0.2s ease;
    }

    .footer-legal-link:hover {
        color: #0064d2;
    }

    .payment-icon {
        background-color: #f3f4f6;
        border: 1px solid #e5e7eb;
        border-radius: 4px;
        padding: 4px 8px;
        min-width: 40px;
        height: 24px;
        display: flex;
        align-items: center;
        justify-content: center;
    }

    .payment-text {
        font-size: 0.75rem;
        font-weight: 500;
        color: #6b7280;
    }

    /* Responsive adjustments */
    @@media (max-width: 960px) {
        .footer-content {
            padding: 32px 0 16px 0;
        }

        .footer-section-title {
            font-size: 1rem;
            margin-bottom: 12px;
        }

        .footer-bottom {
            text-align: center;
        }

        .footer-bottom .d-flex {
            flex-direction: column;
            gap: 16px;
        }

        .payment-icon {
            min-width: 35px;
            height: 20px;
            padding: 2px 6px;
        }

        .payment-text {
            font-size: 0.7rem;
        }
    }

    @@media (max-width: 600px) {
        .footer-content {
            padding: 24px 0 12px 0;
        }

        .social-media .d-flex {
            justify-content: center;
        }

        .newsletter-form {
            text-align: center;
        }
    }

    /* Dark theme support */
    .mud-theme-dark .main-footer {
        background-color: #1f2937;
        border-top-color: #374151;
    }

    .mud-theme-dark .footer-section-title {
        color: #f9fafb;
    }

    .mud-theme-dark .footer-link .mud-typography {
        color: #9ca3af;
    }

    .mud-theme-dark .footer-link:hover .mud-typography {
        color: #22c55e;
    }

    .mud-theme-dark .footer-bottom {
        background-color: #111827;
        border-top-color: #374151;
    }

    .mud-theme-dark .footer-legal-link {
        color: #9ca3af;
    }

    .mud-theme-dark .payment-icon {
        background-color: #374151;
        border-color: #4b5563;
    }

    .mud-theme-dark .payment-text {
        color: #d1d5db;
    }

    .mud-theme-dark .newsletter-input .mud-input-control {
        background-color: #374151;
        border-color: #4b5563;
    }

    .mud-theme-dark .social-media .mud-icon-button {
        background-color: #374151;
        border-color: #4b5563;
    }
</style>